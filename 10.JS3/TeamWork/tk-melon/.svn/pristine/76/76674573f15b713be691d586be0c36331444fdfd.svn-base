function NavigationViewModel() {
	var self = this,
		$loginMail = $('#loginMail'),
		$loginPass = $('#loginPass'),
		$loginBtn = $('#loginBtn'),
		$logoutBtn = $('#logoutBtn'),
		$pageContainer = $('#pagesContainer');

	self.pages = ['projects', 'calendar'];
	self.currentPage = ko.observable(false);
	self.currentUserID = ko.observable(false);

	self.login = function () {
		$.ajax({
			type: 'POST',
			url: 'ss/controller.php',
			data: {
				action: 'login',
				email : $loginMail.val(),
				password : $loginPass.val()
			}
		}).done(function (response) {
			if (response.success) {
				$loginMail.val('');
				$loginPass.val('');
				self.currentUserID(response.userid);
			} else {
				$loginBtn.popover('show');
			}
		});
	};

	self.logout = function () {
		$.ajax({
			type: 'POST',
			url: 'ss/controller.php',
			data: {
				action: 'logout'
			}
		}).done(function (response) {
			if (response.success) {
				self.currentUserID(false);
			}
		});
	};

	self.getCurrentUserId = function () {
		$.ajax({
			type: 'POST',
			url: 'ss/controller.php',
			data: {
				action: 'getCurrentUserId'
			}
		}).done(function (response) {
			if (response.success) {
				self.currentUserID(response.data);
			}
		});
	};

	self.attachPopover = function () {
		$loginBtn.popover({
			animation : true,
			placement : 'bottom',
			trigger : 'manual',
			content : 'Invalid Email or Password..'
		});
	};

	self.hidePopover = function () {
		$loginBtn.popover('hide');
	};

	self.gotoPage = function (page) {
		location.hash = page;
	};

	self.renderPage = function (page, id) {
		if (!page) {
			return;
		}

		if (id) {
			$pageContainer.load(page + 'IDPage.html');
		} else {
			$pageContainer.load(page + 'Page.html');
		}

		$pageContainer.hide().fadeIn(300);
	};

	self.initNavigation = function () {
		// TODO: FIX LOGIN/LOGOUT NAVIGATION
		Sammy(function () {
			this.get('#:page', function() {
				self.currentPage(this.params.page);
				self.renderPage(this.params.page);
			});

			this.get('#:page/:pageID', function() {
				self.currentPage(false);
				self.renderPage(
					this.params.page,
					this.params.pageID);
			});

			this.get('', function () {
				if (self.currentUserID()) {
					this.app.runRoute('get', '#overview');
				} else {
					this.app.runRoute('get', '#main');
				}
			});
		}).run();
	};

	self.attachPopover();
	self.getCurrentUserId();
	self.initNavigation();
};