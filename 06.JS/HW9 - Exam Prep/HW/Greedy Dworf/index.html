<!DOCTYPE HTML>
<html>
	<head>
		<title>Generate list from string with placeholders</title>
		<link rel="stylesheet" type="text/css" href="styles/style.css" />
		<link rel="stylesheet" type="text/css" href="styles/js-console.css" />
	</head>
	<body>
		<div id="js-console">
		</div>
		<script type="text/JavaScript" src="scripts/js-console.js"></script>
		<script type="text/javascript">

		function CalcPath(valley, path){
			var index = 0;
			var pathIndex = 0;
			var totalCoins = 0;
			var visitedIndexes = [];

			while((index >= 0) && 
				  (index < valley.length) && 
				  (visitedIndexes.indexOf(index)===-1)){
				totalCoins += valley[index];
				visitedIndexes.push(index);
				index += path[pathIndex];

				if (pathIndex == path.length-1)
					pathIndex = 0;
				else
					pathIndex++;
			}

			return totalCoins;
		}

		function Solve(args){
			var valley = args[0].split(",");

			for (var i = 0; i < valley.length; i++) {
				valley[i] = parseInt(valley[i].trim());
			};

			var numberOfPaths = parseInt(args[1]);
			var possiblePaths = [];

			for (var i = 0; i < numberOfPaths; i++) {
				possiblePaths[i] = args[i+2];
				possiblePaths[i] = possiblePaths[i].split(",");

				for (var j = 0; j < possiblePaths[i].length; j++) {
					possiblePaths[i][j] = parseInt(possiblePaths[i][j].trim());
				};
			};
			
			var maxCoins = CalcPath(valley, possiblePaths[0]);
			var currentCoins = 0;
			for (var i = 1; i < numberOfPaths; i++) {
				currentCoins = CalcPath(valley, possiblePaths[i]);
				if (maxCoins < currentCoins)
					maxCoins = currentCoins;
			};

			return maxCoins;
		}

		console.log(Solve(["1, 3, -6, 7, 4 ,1, 12", "3", "1, 2, -3", "1, 3, -2", "1, -1"]));

		</script>
	</body>
</html>